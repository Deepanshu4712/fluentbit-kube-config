[PARSER]
    Name postgresParser
    Format regex
    Regex <(?<time>[0-9\a-z]+)> (?<level>[^ ]*): (?<message>.*)
    Time_format %Y-%m-%d %H:%M:%S %Z
    Time_key time

[PARSER]
    Name postgres_slowquery_firstline
    Format regex
    Regex {"log":"\\u003c\s(?<time>[\w\s\-:.]*)\s*\\u003e\sLOG:\s+duration:\s*(?<duration>[\w.]*)\s*(ms|s)\s+statement\s*:\s*(?<multiline_message>.*)
    Time_format %Y-%m-%d %H:%M:%S %Z
    Time_key time
    Types duration:float

[PARSER]
    Name postgres_slowquery_multiline
    Format regex
    Regex {"log":"\\u003c\s(?<time>[\w\s\-:.]*)\s*\\u003e\sLOG:\s+duration:\s*(?<duration>[\w.]*)\s*(ms|s)\s+statement\s*:\s*(?<multiline_message>.*)
    Time_format %Y-%m-%d %H:%M:%S %Z
    Time_key time
    Types duration:float

[PARSER]
    Name elasticFirstLine
    Format regex
    Regex {"log":"[\[](?<time>[^\]]*)[\]]\[(?<level>[^\]]*)\]\[(?<logging_class>[^\]]*)\] (?<multiline_message>[\s\S]*)
    Time_format %Y-%m-%dT%H:%M:%S,%L
    Time_keep On
    Time_key time

[PARSER]
    Name kafkaFirstLine
    Format regex
    Regex {"log":"[\[](?<time>[^\]]*)\]\s(?<level>[^\ ]*)\s(?<message>.*)
    Time_format %Y-%m-%dT%H:%M:%S,%L
    Time_keep On
    Time_key time

[PARSER]
    Name zookeeperFirstLine
    Format regex
    Regex {"log":"[\[](?<time>[^\]]*)\]\s(?<level>[^\ ]*)\s(?<message>.*)
    Time_format %Y-%m-%dT%H:%M:%S,%L
    Time_keep On
    Time_key time

[PARSER]
    Name mysqlGeneral
    Time_key event_time
    Format regex
    Regex (?<event_time>[^Z]*Z)\s+(?<id>\d+)\s+(?<command>(Connect)|(Query)|(Quit))\s+(?<argument>[^\t].*)$
    Time_format %Y-%m-%dT%H:%M:%S.%LZ
    Types id:integer

[PARSER]
    Name mysql-slowquery-header
    Time_Key logTime
    Format regex
    Regex #\sTime:\s(?<logTime>(?<date>\d{1,4}-?\d{1,2}-?\d{1,2})\T?\s*(?<time>\d{1,2}:\d{2}:\d{2}.[^Z]*Z))
    Time_format %Y-%m-%dT%H:%M:%S.%LZ

[PARSER]
    Name mysql-slowquery-time
    Time_Key logTime
    Format regex
    Regex /(?m-xi)#\sTime:\s(?<logTime>(?<date>\d{1,4}-?\d{1,2}-?\d{1,2})\T?\s*(?<time>\d{1,2}:\d{2}:\d{2}.[^Z]*Z))
    Time_format %Y-%m-%dT%H:%M:%S.%LZ

[PARSER]
    Name mysql-slowquery-user
    Format regex
    Regex /#\sUser@Host: (?<user>\w*)[^@]*@\s*[^\[]*\[(?<host>[\w\.\:]*)\]\s*Id:\s*(?<id>\d*)/
    Types id:integer

[PARSER]
    Name mysqlError
    Time_Key time
    Format regex
    Regex (?<time>[^ ]*)\s(?<id>\d*)\s*\[(?<level>\S+)\]\s(?<message>.*)$
    Time_format %Y-%m-%dT%H:%M:%S.%LZ
    Types id:integer


[PARSER]
    Name mysql-slowquery-query-details
    Format regex
    Regex /#\sQuery_time:\s*(?<query_time>[\d\.]*)\s*Lock_time:\s*(?<lock_time>[\d\.]*)\s*Rows_sent:\s*(?<rows_sent>[\d\.]*)\s*Rows_examined:\s*(?<rows_examined>[\d\.]*)/
    Types query_time:float lock_time:float rows_sent:float rows_examined:float

[PARSER]
    Name mysql-slowquery-timestamp
    Format regex
    Regex /SET timestamp=(?<timestamp>\d{0,13})/

[PARSER]
    Name mysql-slowquery-query
    Format regex
    Regex {"log":"(?<query>.*)\\n"

[PARSER]
    Name jmeterParser
    Format regex
    Regex (?<time>\d*),(?<elapsed>\d*),(?<label>[\w\s]*),(?<code>[\w\:\.\s]*),(?<message>[\w\[\]\.\s:\(\)\/]*),(?<threadName>[\w\s-]*),(?<dataType>[a-zA-Z]*),(?<requestSuccess>\w*),(?<failureMessage>[\w\[\]\.\s:\(\)\/]*),(?<bytes>\w*),(?<sentBytes>[\w\s-]*),(?<grpThreads>\d*),(?<allThreads>\d*),(?<url>[\w:\/\.\-]*),(?<Latency>\d*),(?<IdleTime>\d*),(?<Connect>\d*)
    Types elapsed:float bytes:integer sentBytes:integer IdleTime:float Connect:float

[PARSER]
    Name apache-access
    Format regex
    Regex ^(?<host>[^\s]*(?:\s+[^\s]+)*)\s[\-](?<user>[\w\s]*)[\-]\s\[(?<time>[^\]]*)\]\s"(?<method>GET|POST|HEAD|PUT|DELETE|CONNECT|OPTIONS|TRACE)\s(?<path>[^"]*)\s(?<header>[^\s]*)\"\s(?<code>[^\s]*)\s(?<size>[^\s]*)\s(?:"(?<referer>[^\"]*)"\s"(?<agent>(\S*\s\((?<BrowserOS>[^\s;]*).*\)\s(?<browserField1>\w*)\/[\d.]*\s(?:(?<mobile>Mobile)[\/\S.]*\s)?(?<browserField2>[\w\s]*)\/[\d.]*\s?(?:(?<browserField3>\w*)\/[\d.]*)?)|(.*))"\s(?:(|)(?<response_time>[^\s]*)))?$
    Time_format %d/%b/%Y:%H:%M:%S %Z
    Time_key time
    Types response_time:float size:integer

[PARSER]
    Name apache-error
    Format regex
    Regex ^\[[^ ]* (?<time>[^\]]*)\] \[(?<level>[^\]]*)\](?: \[pid (?<id>[^\]]*)\])?( \[client (?<client>[^\]]*)\])? (?<message>.*)$
    Time_format %b %d %H:%M:%S.%L %Y
    Time_key time

[PARSER]
    Name nginx-access
    Format regex
    Regex ^(?<host>[^ ]*)\s(?<user>[^ ]*)\s\[(?<time>[^\]]*)\]\s\"(?<method>GET|POST|HEAD|PUT|DELETE|CONNECT|OPTIONS|TRACE)\s(?<path>[^"]*)\s(?<header>[^ ]*)\"\s(?<code>[^ ]*)\s(?<size>[^ ]*)\s\"(?<referer>[^"]*)\"\s\"(?<agent>(\S*\s\((?<BrowserOS>[^\s;]*).*\)\s(?<browserField1>\w*)\/[\d.]*\s(?:(?<mobile>Mobile)[\/\S.]*\s)?(?<browserField2>[\w\s]*)\/[\d.]*\s?(?:(?<browserField3>\w*)\/[\d.]*)?)|(.*))\"\s\"(?<referer2>[^"]*)\"\s(rt=(?<request_time>[^ ]*))\s(uct=(?<upstream_connect_time>[^ ]*))\s(uht=(?<upstream_header_time>[^ ]*))\s(urt=(?<upstream_response_time>[^ ]*))$
    Time_format %d/%b/%Y:%H:%M:%S %z
    Time_key time
    Types request_time:float upstream_connect_time:float upstream_header_time:float upstream_response_time:float size:integer


[PARSER]
    Name nginx-error
    Format regex
    Regex (?<time>[^ ]* [^ ]*)\s*\[(?<level>\S+)\]\s*(?<pid>\d+)#(?<tid>\d+)\:\s*(?<message>.*)$
    Time_format %Y/%m/%d %H:%M:%S



[PARSER]
    # https://rubular.com/r/IhIbCAIs7ImOkc
    Name        k8s-nginx-ingress
    Format      regex
    Regex       ^(?<host>[^ ]*) - (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^\"]*?)(?: +\S*)?)?" (?<code>[^ ]*) (?<size>[^ ]*) "(?<referer>[^\"]*)" "(?<agent>[^\"]*)" (?<request_length>[^ ]*) (?<request_time>[^ ]*) \[(?<proxy_upstream_name>[^ ]*)\] (\[(?<proxy_alternative_upstream_name>[^ ]*)\] )?(?<upstream_addr>[^ ]*) (?<upstream_response_length>[^ ]*) (?<upstream_response_time>[^ ]*) (?<upstream_status>[^ ]*) (?<reg_id>[^ ]*).*$
    Time_Key    time
    Time_Format %d/%b/%Y:%H:%M:%S %z

[PARSER]
    Name   json
    Format json
    Time_Key time
    Time_Format %d/%b/%Y:%H:%M:%S %z

[PARSER]
    Name         docker
    Format       json
    Time_Key     time
    Time_Format  %Y-%m-%dT%H:%M:%S.%L
    Time_Keep    On
    # --
    # Since Fluent Bit v1.2, if you are parsing Docker logs and using
    # the Kubernetes filter, it's not longer required to decode the
    # 'log' key.
    #
    # Command      |  Decoder | Field | Optional Action
    # =============|==================|=================
    #Decode_Field_As    json     log

[PARSER]
    Name        docker-daemon
    Format      regex
    Regex       time="(?<time>[^ ]*)" level=(?<level>[^ ]*) msg="(?<msg>[^ ].*)"
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On

[PARSER]
    Name        syslog-rfc5424
    Format      regex
    Regex       ^\<(?<pri>[0-9]{1,5})\>1 (?<time>[^ ]+) (?<host>[^ ]+) (?<ident>[^ ]+) (?<pid>[-0-9]+) (?<msgid>[^ ]+) (?<extradata>(\[(.*)\]|-)) (?<message>.+)$
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On

[PARSER]
    Name        syslog-rfc3164-local
    Format      regex
    Regex       ^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.*)$
    Time_Key    time
    Time_Format %b %d %H:%M:%S
    Time_Keep   On

[PARSER]
    Name        syslog-rfc3164
    Format      regex
    Regex       /^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.*)$/
    Time_Key    time
    Time_Format %b %d %H:%M:%S
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On

[PARSER]
    Name    mongodb
    Format  regex
    Regex   ^(?<time>[^ ]*)\s+(?<severity>\w)\s+(?<component>[^ ]+)\s+\[(?<context>[^\]]+)]\s+(?<message>.*?) *(?<ms>(\d+))?(:?ms)?$
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On
    Time_Key time

[PARSER]
    # https://rubular.com/r/3fVxCrE5iFiZim
    Name    envoy
    Format  regex
    Regex ^\[(?<start_time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^\"]*?)(?: +\S*)?)? (?<protocol>\S+)" (?<code>[^ ]*) (?<response_flags>[^ ]*) (?<bytes_received>[^ ]*) (?<bytes_sent>[^ ]*) (?<duration>[^ ]*) (?<x_envoy_upstream_service_time>[^ ]*) "(?<x_forwarded_for>[^ ]*)" "(?<user_agent>[^\"]*)" "(?<request_id>[^\"]*)" "(?<authority>[^ ]*)" "(?<upstream_host>[^ ]*)"
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On
    Time_Key start_time

[PARSER]
    # http://rubular.com/r/tjUt3Awgg4
    Name cri
    Format regex
    Regex ^(?<time>[^ ]+) (?<stream>stdout|stderr) (?<logtag>[^ ]*) (?<message>.*)$
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z

[PARSER]
    Name    kube-custom
    Format  regex
    Regex   (?<tag>[^.]+)?\.?(?<pod_name>[a-z0-9](?:[-a-z0-9]*[a-z0-9])?(?:\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*)_(?<namespace_name>[^_]+)_(?<container_name>.+)-(?<docker_id>[a-z0-9]{64})\.log$

[PARSER]
    # https://github.com/kubernetes/klog/blob/master/klog.go#L575
    Name        klog
    Format      regex
    Regex       (?<level>W|I|F|E)(?<kdate>[\S]+)\s+(?<ktime>[\d:.]+)\s+(?<threadID>[\d]+)\s+(?<fileline>[\S]+)\]\s+(?<message>.*)

[PARSER]
    Name        syslog
    Format      regex
    Regex       (?<time>[^ ]*\s*[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[^:\[]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? (?<message>.*)
    Time_format %b %d %H:%M:%S
    Time_keep   On
    Time_key    time
